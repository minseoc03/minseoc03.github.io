---
layout: single
title:  "RNN Back Propagation"
date:   2024-05-14 21:10:54 
categories: [ml, dl_theory]
author_profile: false
sidebar:
  nav: "ml"
---

## 9-2. RNN Back Propagation

### RNNì˜ ì†ì‹¤ í•¨ìˆ˜

![image 4.png](/assets/images/dl-theory/image%204.png)

- HELLì´ë¼ëŠ” ì…ë ¥ì—ì„œ ë§ˆì§€ë§‰ì— Oë¼ëŠ” ê¸€ìê°€ ë‚˜ì˜¤ë„ë¡ í•˜ëŠ”ê²Œ í•´ë‹¹ ëª¨ë¸ì˜ ëª©í‘œë‹¤.
- ì¦‰, ì•ŒíŒŒë²³ì„ ë§ì¶”ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ë‹¤ì¤‘ ë¶„ë¥˜ ë¬¸ì œì— ì†í•˜ê²Œ ë˜ê³  ì†ì‹¤ ê°’ì€ êµì°¨ ì—”íŠ¸ë¡œí”¼ê°€ ëœë‹¤.
- ê·¸ë ‡ë‹¤ë©´ ì—­ì „íŒŒë¥¼ í†µí•´ Hê°€ ê·¸ë¼ë””ì–¸íŠ¸ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ë ¥ì„ ì‚´í´ë³´ì

### RNNì˜ ì—­ì „íŒŒ

![image.png](/assets/images/dl-theory/image%201%202.png)

- ì˜ˆì‹œë¡œ 3ë²ˆì§¸ ë‹¨ê³„ê¹Œì§€ë§Œ ìˆëŠ” RNNì´ë¼ê³  í•˜ì.
- í•™ìŠµë˜ëŠ” íŒŒë¼ë¯¸í„°ëŠ” $W_x, W_h, W_y, \vec b, \vec b_y$ ì´ 5ê°œì´ì§€ë§Œ ê°€ì¤‘ì¹˜ë§Œ í¸ë¯¸ë¶„ì„ í•´ë³´ì.
- $W_y$ì˜ í¸ë¯¸ë¶„
    - $\dfrac{\partial L}{\partial W_y} = \dfrac{\partial L}{\partial \hat y_3}\dfrac{\partial \hat y_3}{\partial W_y}$
- $W_h$ì˜ í¸ë¯¸ë¶„
    - $\dfrac{\partial L}{\partial W_h} = \dfrac{\partial L}{\partial \hat y_3}\dfrac{\partial \hat y_3}{\partial h_3}\dfrac{\partial h_3}{\partial W_h} + \dfrac{\partial L}{\partial \hat y_3}\dfrac{\partial \hat y_3}{\partial h_3}\dfrac{\partial h_3}{\partial h_2}\dfrac{\partial h_2}{\partial W_h}$
    - $W_h$ê°€ ì“°ì´ëŠ” ê³³ì´ ë‘ ê³³ì´ë¯€ë¡œ ë‘ ê³³ ë‹¤ í¸ë¯¸ë¶„ ì§„í–‰ í›„ ë§ì…ˆ
- $W_x$ì˜ í¸ë¯¸ë¶„
    - $\dfrac{\partial L}{\partial W_x} = \dfrac{\partial L}{\partial \hat y_3}\dfrac{\partial \hat y_3}{\partial h_3}\dfrac{\partial h_3}{\partial W_x} + \dfrac{\partial L}{\partial \hat y_3}\dfrac{\partial \hat y_3}{\partial h_3}\dfrac{\partial h_3}{\partial h_2}\dfrac{\partial h_2}{\partial W_x} + \dfrac{\partial L}{\partial \hat y_3}\dfrac{\partial \hat y_3}{\partial h_3}\dfrac{\partial h_3}{\partial h_2}\dfrac{\partial h_2}{\partial h_1}\dfrac{\partial h_1}{\partial W_x}$
    - ê²°êµ­ ì•¡ * $x_3$ + ì•¡ * ì›¨ * ì•¡ * $x_2$ + ì•¡ * ì›¨ * ì•¡ * ì›¨ * ì•¡ * $x_1$ì˜ í˜•íƒœê°€ ë‚˜ì˜¨ë‹¤.
    - í•˜ì§€ë§Œ $x_1$ì— ëŒ€í•´ì„œëŠ” ê³±í•´ì§€ëŠ” ê°’ë“¤ì´ ë„ˆë¬´ ë§ì•„ ê·¸ë¼ë””ì–¸íŠ¸ì— ëŒ€í•œ ì˜í–¥ë ¥ì´ ì–•ì•„ì§„ë‹¤.

### RNNì˜ êµ¬ì¡°ì  í•œê³„ì 

<aside>
ğŸ’¡

ì¦‰, ì—­ì „íŒŒì˜ ì…ì¥ì—ì„œëŠ” ë©€ìˆ˜ë¡ ì´ˆë°˜ì— ìˆëŠ” ë°ì´í„°ë“¤ì€ ìŠí˜€ì§„ë‹¤.

ìˆœì „íŒŒì˜ ì…ì¥ì—ì„œëŠ” tanh í™œì„±í™” í•¨ìˆ˜ ë•Œë¬¸ì— ì•ìœ¼ë¡œ ê°ˆìˆ˜ë¡ ì´ˆë°˜ì— ìˆëŠ” ë°ì´í„°ëŠ” íë ¤ì§„ë‹¤.

</aside>

### íŒŒì´ì¬ ì‹¤ìŠµ

![image.png](/assets/images/dl-theory/image%202%201.png)

- íŒŒì´ì¬ ì½”ë“œë¡œ ì‹¤ì œë¡œ RNNì„ ëŒë ¤ë³¸ ê²°ê³¼ì´ë‹¤.
- $h_4$ë¶€í„° $h_1$ê¹Œì§€ ê°ˆìˆ˜ë¡ ê·¸ë¼ë””ì–¸íŠ¸ ê°’ì´ ì¤„ì–´ë“¤ê³  $h_1$ì€ ê±°ì˜ 0ì— ìˆ˜ë ´í•˜ëŠ” ê²ƒì„ ë³¼ìˆ˜ê°€ ìˆë‹¤.