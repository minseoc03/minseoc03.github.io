---
layout: single
title:  "CNN with 3D input"
date:   2024-05-09 21:10:54 
categories: [ml, dl_theory]
author_profile: false
sidebar:
  nav: "ml"
---

## 8-3. CNN w/ 3D 입력

### 컬러 이미지에 대한 합성곱 연산

- 컬러 이미지는 채널이 3개이므로 깊이가 3인 입력 이미지 데이터이다.
- 그렇다면 커널의 사이즈는 어떻게 되야할까?
- 무조건 입력 이미지의 채널 수에 맞추면 된다.
    - 입력 이미지가 RGB로 되어 있다면 커널의 깊이도 3으로 해야되고 가로 세로 사이즈는 원하는대로 정해주면 된다.

![image 10.png](/assets/images/dl-theory/image%2010.png)

- 하지만 여기서 헷갈릴 수 있는 부분이 하나 있다.
    - 커널의 채널이 3개라고 해서 출력 채널이 3이 아니다.
    - 커널 채널 3개의 내적 합이 출력이 되므로 필터의 갯수가 출력 값의 채널 갯수가 된다.
- 보다 싶이 커널을 2개를 사용해서 출력 된 필터 맵이 2개 채널을 가지고 있다.

- 그리고 입력 되는 데이터가 채널이 2개이므로 이때 사용되는 커널의 채널도 2개이다.
- 이후 3개의 커널을 통과시키면 다시 채널이 3개로 돌아오는 것을 볼 수 있다.

![image.png](/assets/images/dl-theory/image%201%208.png)